<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="light" />
  <title>Ruken & Samet | Ni≈üan Anƒ±larƒ±</title>

  <style>
    :root{
      /* ‚úÖ ARKA PLANLA UYUMLU SAGE/OLIVE PALET */
      --sage-950:#1f2b22;
      --sage-900:#26352a;
      --sage-800:#2f4335;
      --sage-700:#395040;
      --sage-650:#3f5a47;
      --sage-600:#486553;

      --leaf:#5f7a62;        /* buton/√ßizgi i√ßin canlƒ± yaprak tonu */
      --gold:#cbb57e;        /* sƒ±cak vurgu */
      --ivory:#fffaf1;       /* krem zemin */
      --ivory2:rgba(255,250,241,.88);

      --ink:#152018;
      --muted: rgba(21,32,24,.68);

      --stroke: rgba(47,67,53,.16);
      --shadow: 0 26px 90px rgba(10,28,21,.14);
      --shadow-soft: 0 14px 32px rgba(10,28,21,.10);

      --r-xl: 28px;
      --r-lg: 18px;

      --ok:#167a3a;
      --err:#c62828;

      /* ‚úÖ Tek arka plan g√∂rseli */
      --bg: url("assets/floral-bg.png?v=1300");
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      color: var(--ink);
      min-height: 100dvh;
      padding: max(16px, env(safe-area-inset-top)) 14px max(18px, env(safe-area-inset-bottom));
      display:grid;
      place-items:center;
      overflow-x:hidden;
      background: #eef6ef;
    }

    /* ‚úÖ Arka plan (tek g√∂rsel) */
    .bg{
      position:fixed; inset:0; z-index:0;
      pointer-events:none;
      background: var(--bg) center/cover no-repeat;
      filter: saturate(1.12) contrast(1.05);
    }
    /* okunabilirlik i√ßin hafif ‚Äúpaper‚Äù overlay */
    .bg::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(1200px 760px at 18% 18%, rgba(95,122,98,.14), transparent 62%),
        radial-gradient(1200px 760px at 82% 86%, rgba(203,181,126,.10), transparent 62%),
        linear-gradient(135deg, rgba(255,250,241,.44), rgba(238,246,239,.18));
      opacity:.86;
    }

    .wrap{ width:min(920px, 100%); position:relative; z-index:1; }

    .card{
      border-radius: var(--r-xl);
      background: var(--ivory2);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
    }

    /* ‚úÖ HEADER: arka planla uyumlu SAGE */
    .header{
      padding: 18px 18px 16px;
      background:
        radial-gradient(900px 260px at 18% 0%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(700px 240px at 88% 100%, rgba(255,255,255,.10), transparent 58%),
        linear-gradient(135deg, var(--sage-900), var(--sage-650));
      color:#fff;
      position:relative;
    }
    .header::after{
      content:"";
      position:absolute; left:0; right:0; bottom:0;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(203,181,126,.9), transparent);
      opacity:.9;
      pointer-events:none;
    }

    .top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      font-size: 12px;
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.22);
      backdrop-filter: blur(6px);
      white-space:nowrap;
    }
    .date{ font-size:12px; opacity:.92; white-space:nowrap; }

    .title{
      margin: 12px 0 4px;
      font-size: 34px;
      letter-spacing:.2px;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }
    .badgeRing{
      width:34px; height:34px;
      border-radius: 14px;
      display:grid; place-items:center;
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.20);
      box-shadow: 0 10px 26px rgba(0,0,0,.10);
    }

    .subtitle{
      margin:0;
      font-size: 14px;
      opacity:.95;
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }
    .subtitle .dot{
      width:7px;height:7px;border-radius:999px;
      background: rgba(203,181,126,.92);
      display:inline-block;
      box-shadow: 0 0 0 4px rgba(203,181,126,.14);
    }

    .content{
      padding: 16px 18px 18px;
      background: rgba(255,250,241,.56);
    }

    /* ‚úÖ Dropzone: krem + sage border */
    .dropzone{
      display:block;
      width:100%;
      border-radius: var(--r-lg);
      border: 1.6px dashed rgba(72,101,83,.48);
      background:
        radial-gradient(700px 240px at 10% 20%, rgba(95,122,98,.12), transparent 58%),
        radial-gradient(700px 240px at 90% 90%, rgba(203,181,126,.12), transparent 58%),
        linear-gradient(180deg, rgba(255,250,241,.96), rgba(255,250,241,.88));
      padding: 16px;
      cursor:pointer;
      user-select:none;
      transition: transform .16s ease, border-color .16s ease, box-shadow .16s ease;
      box-shadow: var(--shadow-soft);
      outline:none;
    }
    .dropzone:hover{
      transform: translateY(-1px);
      border-color: rgba(72,101,83,.68);
    }
    .dropzone.dragover{
      border-color: rgba(203,181,126,.85);
      box-shadow: 0 18px 44px rgba(10,28,21,.12);
      transform: translateY(-1px);
    }

    .dzTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .dzTitle{
      font-weight: 950;
      color: var(--sage-900);
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 15px;
    }
    .pill{
      font-size: 12px;
      color: rgba(21,32,24,.76);
      background: rgba(255,250,241,.92);
      border: 1px solid rgba(203,181,126,.45);
      padding: 6px 10px;
      border-radius: 999px;
      white-space:nowrap;
      box-shadow: 0 8px 18px rgba(10,28,21,.06);
    }
    .dzHint{
      margin:0;
      font-size: 13px;
      color: rgba(21,32,24,.70);
      line-height:1.45;
    }
    input[type=file]{ display:none; }

    /* ‚úÖ √ñnizleme: k√º√ß√ºk k√º√ß√ºk */
    .preview{
      margin-top: 14px;
      display:none;
      border-radius: var(--r-lg);
      border: 1px solid rgba(47,67,53,.10);
      background: rgba(255,250,241,.78);
      overflow:hidden;
      box-shadow: 0 14px 40px rgba(10,28,21,.10);
    }
    .previewHead{
      padding: 10px 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      font-size: 12px;
      color: rgba(21,32,24,.70);
      background: linear-gradient(90deg, rgba(95,122,98,.14), rgba(203,181,126,.12));
      border-bottom: 1px solid rgba(47,67,53,.08);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 10px;
      padding: 12px;
    }
    @media (max-width:980px){ .grid{ grid-template-columns: repeat(5, 1fr); } }
    @media (max-width:820px){ .grid{ grid-template-columns: repeat(4, 1fr); } }
    @media (max-width:620px){ .grid{ grid-template-columns: repeat(3, 1fr); gap:8px; padding:10px; } }
    @media (max-width:380px){ .grid{ grid-template-columns: repeat(2, 1fr); } }

    .item{
      border-radius: 14px;
      border: 1px solid rgba(47,67,53,.10);
      background: rgba(255,250,241,.94);
      overflow:hidden;
      box-shadow: 0 10px 20px rgba(10,28,21,.06);
      display:flex;
      flex-direction:column;
    }
    .thumb{
      position:relative;
      aspect-ratio: 1 / 1;
      background: rgba(47,67,53,.05);
      overflow:hidden;
    }
    .thumb img, .thumb video{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
    }
    .typeBadge{
      position:absolute;
      left:8px; top:8px;
      padding: 5px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(38,53,42,.78);
      color:#fff;
      border: 1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(4px);
    }

    .meta{
      padding: 8px 8px 10px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .name{ min-width:0; }
    .name b{
      display:block;
      font-size: 12px;
      font-weight: 950;
      color: var(--sage-900);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .name span{
      display:block;
      font-size: 11px;
      color: rgba(21,32,24,.64);
      margin-top: 1px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .remove{
      border:none;
      cursor:pointer;
      background: rgba(255,250,241,.96);
      border: 1px solid rgba(203,181,126,.55);
      color: rgba(21,32,24,.84);
      border-radius: 12px;
      padding: 7px 9px;
      font-weight: 950;
    }

    /* ‚úÖ Butonlar: sage primary, gold line; secondary krem */
    .actions{
      margin-top: 12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .btn{
      border:none;
      cursor:pointer;
      border-radius: 16px;
      padding: 12px 14px;
      font-weight: 950;
      font-size: 14px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      transition: transform .16s ease, opacity .16s ease;
      min-height: 48px;
    }
    .btn:disabled{ opacity:.55; cursor:not-allowed; transform:none; }
    .btn:hover{ transform: translateY(-1px); }

    .btn.primary{
      color:#fff;
      background:
        radial-gradient(700px 180px at 20% 30%, rgba(203,181,126,.18), transparent 55%),
        linear-gradient(135deg, var(--sage-900), var(--leaf));
      box-shadow: 0 16px 36px rgba(15,47,36,.16);
      border: 1px solid rgba(255,255,255,.10);
    }
    .btn.secondary{
      color: var(--sage-900);
      background: rgba(255,250,241,.94);
      border: 1px solid rgba(72,101,83,.22);
      box-shadow: 0 10px 22px rgba(10,28,21,.06);
    }

    .status{
      margin-top: 10px;
      font-size: 13px;
      min-height: 18px;
      line-height:1.35;
      color: var(--muted);
    }

    .footer{
      padding: 12px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      border-top: 1px solid rgba(47,67,53,.10);
      background: rgba(255,250,241,.62);
      font-size: 12px;
      color: rgba(21,32,24,.76);
    }
    .footer b{ color: var(--sage-900); font-weight: 950; }

    .toast{
      position:fixed;
      left:50%;
      bottom: max(14px, env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(38,53,42,.92);
      color:#fff;
      padding: 10px 12px;
      border-radius: 14px;
      font-size: 13px;
      box-shadow: 0 18px 40px rgba(0,0,0,.18);
      display:none;
      z-index:10;
      max-width: min(520px, 92vw);
    }

    @media (max-width:560px){
      .title{ font-size: 28px; }
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="toast" id="toast"></div>

  <main class="wrap">
    <section class="card">
      <header class="header">
        <div class="top">
          <div class="chip">üíç Ni≈üan Anƒ± Kutusu ‚Ä¢ Fotoƒüraf & Video</div>
          <div class="date" id="dateLabel"></div>
        </div>

        <h1 class="title">
          <span class="badgeRing">üíç</span>
          Ruken & Samet
        </h1>

        <p class="subtitle">
          <span class="dot"></span>
          Anƒ±larƒ±nƒ±zƒ± bizimle payla≈üƒ±n üåø
        </p>
      </header>

      <div class="content">
        <label class="dropzone" id="dropzone" for="fileInput">
          <div class="dzTop">
            <div class="dzTitle">üì∏ Fotoƒüraf / üé• Video se√ßin</div>
            <div class="pill">Maks: 25 dosya ‚Ä¢ Toplam: 250 MB</div>
          </div>
          <p class="dzHint">Tƒ±klayƒ±n veya s√ºr√ºkleyip bƒ±rakƒ±n. G√∂ndermeden √∂nce k√º√ß√ºk √∂nizlemeler g√∂receksiniz.</p>
          <input id="fileInput" type="file" multiple accept="image/*,video/*" />
        </label>

        <div class="preview" id="preview">
          <div class="previewHead">
            <div id="countLabel">0 dosya</div>
            <div id="sizeLabel">0 MB</div>
          </div>
          <div class="grid" id="grid"></div>
        </div>

        <div class="actions">
          <button class="btn secondary" id="clearBtn" type="button" disabled>üßπ Temizle</button>
          <button class="btn primary" id="uploadBtn" type="button" disabled>‚¨ÜÔ∏è G√∂nder</button>
        </div>

        <div class="status" id="status"></div>
      </div>

      <footer class="footer">
        <div>üìå Y√ºkleme bitene kadar sayfayƒ± kapatmayƒ±n.</div>
        <div><b>Ruken</b> & <b>Samet</b> ‚Ä¢ Te≈üekk√ºrler ü§ç</div>
      </footer>
    </section>
  </main>

<script>
  const API_URL = "https://script.google.com/macros/s/AKfycbwIgq1XMRIH4l0nubP-5HRUl9Znq2MzimEGLlRGzoiKJnSjXe3UYs9KYUlI3XdlL2kw/exec";

  const MAX_FILES = 25;
  const MAX_TOTAL_MB = 250;

  const el = (id)=>document.getElementById(id);

  const fileInput = el("fileInput");
  const dropzone  = el("dropzone");
  const preview   = el("preview");
  const grid      = el("grid");
  const countLabel= el("countLabel");
  const sizeLabel = el("sizeLabel");
  const uploadBtn = el("uploadBtn");
  const clearBtn  = el("clearBtn");
  const statusEl  = el("status");
  const toastEl   = el("toast");

  let files = [];
  let urls  = new Map();
  let busy  = false;

  (function setDate(){
    const d = new Date();
    const months = ["Ocak","≈ûubat","Mart","Nisan","Mayƒ±s","Haziran","Temmuz","Aƒüustos","Eyl√ºl","Ekim","Kasƒ±m","Aralƒ±k"];
    el("dateLabel").textContent = `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;
  })();

  function showToast(msg){
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(showToast._t);
    showToast._t = setTimeout(()=> toastEl.style.display = "none", 2400);
  }

  function setStatus(msg, type="default"){
    statusEl.textContent = msg || "";
    statusEl.style.color =
      type === "ok"  ? "var(--ok)" :
      type === "err" ? "var(--err)" :
      "rgba(21,32,24,.70)";
  }

  function formatMB(bytes){
    const mb = bytes / (1024*1024);
    return mb >= 10 ? mb.toFixed(0) : mb.toFixed(1);
  }

  function totalBytes(list){ return list.reduce((a,f)=>a+f.size,0); }
  function isAllowed(f){ return f.type?.startsWith("image/") || f.type?.startsWith("video/"); }
  function keyOf(f){ return `${f.name}__${f.size}__${f.lastModified}`; }

  function clearAll(){
    for(const u of urls.values()) URL.revokeObjectURL(u);
    urls.clear();
    files = [];
    fileInput.value = "";
    render();
    setStatus("");
  }

  function validate(list){
    if(list.length === 0) return {ok:false, msg:"Dosya se√ßilmedi."};
    if(list.length > MAX_FILES) return {ok:false, msg:`En fazla ${MAX_FILES} dosya se√ßebilirsiniz.`};
    const mb = totalBytes(list)/(1024*1024);
    if(mb > MAX_TOTAL_MB) return {ok:false, msg:`Toplam boyut ${MAX_TOTAL_MB} MB‚Äôƒ± ge√ßemez. (≈ûu an: ${mb.toFixed(1)} MB)`};
    return {ok:true};
  }

  function render(){
    grid.innerHTML = "";

    if(files.length === 0){
      preview.style.display = "none";
      uploadBtn.disabled = true;
      clearBtn.disabled = true;
      return;
    }

    preview.style.display = "block";
    uploadBtn.disabled = busy;
    clearBtn.disabled = busy;

    countLabel.textContent = `${files.length} dosya`;
    sizeLabel.textContent  = `${formatMB(totalBytes(files))} MB`;

    files.forEach((f, idx)=>{
      const k = keyOf(f);
      if(!urls.has(k)) urls.set(k, URL.createObjectURL(f));
      const url = urls.get(k);

      const card = document.createElement("div");
      card.className = "item";

      const thumb = document.createElement("div");
      thumb.className = "thumb";

      const badge = document.createElement("div");
      badge.className = "typeBadge";
      badge.textContent = f.type?.startsWith("video/") ? "üé•" : "üì∑";

      if(f.type?.startsWith("image/")){
        const img = document.createElement("img");
        img.src = url;
        img.alt = f.name;
        thumb.appendChild(img);
      }else{
        const vid = document.createElement("video");
        vid.src = url;
        vid.muted = true;
        vid.playsInline = true;
        vid.preload = "metadata";
        thumb.appendChild(vid);
      }
      thumb.appendChild(badge);

      const meta = document.createElement("div");
      meta.className = "meta";

      const name = document.createElement("div");
      name.className = "name";
      const b = document.createElement("b");
      b.textContent = f.name;
      const s = document.createElement("span");
      s.textContent = `${formatMB(f.size)} MB`;
      name.appendChild(b);
      name.appendChild(s);

      const rm = document.createElement("button");
      rm.className = "remove";
      rm.type = "button";
      rm.textContent = "Sil";
      rm.onclick = ()=>{
        if(busy) return;
        const kk = keyOf(files[idx]);
        if(urls.has(kk)){ URL.revokeObjectURL(urls.get(kk)); urls.delete(kk); }
        files = files.filter((_, i)=> i !== idx);
        render();
        showToast("Silindi");
      };

      meta.appendChild(name);
      meta.appendChild(rm);

      card.appendChild(thumb);
      card.appendChild(meta);
      grid.appendChild(card);
    });
  }

  fileInput.addEventListener("change", (e)=>{
    if(busy) return;
    const picked = [...e.target.files].filter(isAllowed);
    const v = validate(picked);
    if(!v.ok){
      setStatus(v.msg, "err");
      fileInput.value = "";
      return;
    }
    clearAll();
    files = picked;
    setStatus("√ñnizleme hazƒ±r. ƒ∞sterseniz bazƒ±larƒ±nƒ± silip sonra ‚ÄúG√∂nder‚Äù diyebilirsiniz.");
    render();
  });

  ["dragenter","dragover"].forEach(ev=>{
    dropzone.addEventListener(ev, (e)=>{
      e.preventDefault(); e.stopPropagation();
      dropzone.classList.add("dragover");
    });
  });
  ["dragleave","drop"].forEach(ev=>{
    dropzone.addEventListener(ev, (e)=>{
      e.preventDefault(); e.stopPropagation();
      dropzone.classList.remove("dragover");
    });
  });
  dropzone.addEventListener("drop", (e)=>{
    if(busy) return;
    const dropped = [...e.dataTransfer.files].filter(isAllowed);
    const v = validate(dropped);
    if(!v.ok){
      setStatus(v.msg || "Sadece fotoƒüraf/video ekleyebilirsiniz.", "err");
      return;
    }
    clearAll();
    files = dropped;
    setStatus("√ñnizleme hazƒ±r. ƒ∞sterseniz bazƒ±larƒ±nƒ± silip sonra ‚ÄúG√∂nder‚Äù diyebilirsiniz.");
    render();
  });

  clearBtn.addEventListener("click", ()=>{
    if(busy) return;
    clearAll();
    showToast("Temizlendi");
  });

  uploadBtn.addEventListener("click", async ()=>{
    if(busy) return;
    if(files.length === 0){
      setStatus("Dosya se√ßilmedi.", "err");
      return;
    }

    busy = true;
    uploadBtn.disabled = true;
    clearBtn.disabled = true;
    fileInput.disabled = true;

    try{
      setStatus("Y√ºkleme ba≈üladƒ±‚Ä¶");
      let done = 0;

      for(const f of files){
        await uploadFile(f);
        done++;
        setStatus(`Y√ºkleniyor‚Ä¶ (${done}/${files.length})`);
      }

      setStatus("üéâ Ba≈üarƒ±yla g√∂nderildi. Te≈üekk√ºrler!", "ok");
      showToast("G√∂nderildi ‚úÖ");
      clearAll();

    }catch(err){
      setStatus("HATA: " + String(err), "err");
      showToast("Hata olu≈ütu");
    }finally{
      busy = false;
      uploadBtn.disabled = files.length === 0;
      clearBtn.disabled = files.length === 0;
      fileInput.disabled = false;
      render();
    }
  });

  function uploadFile(file){
    return new Promise((resolve, reject)=>{
      const reader = new FileReader();

      reader.onload = async ()=>{
        try{
          const base64 = String(reader.result).split(",")[1];

          const res = await fetch(API_URL, {
            method: "POST",
            body: new URLSearchParams({
              file: base64,
              originalName: file.name,
              type: file.type || "application/octet-stream"
            })
          });

          const text = await res.text();
          let json;
          try{ json = JSON.parse(text); }
          catch{ return reject("Sunucu JSON d√∂nmedi. Deploy/izin kontrol edin."); }

          if(json.status !== "ok") return reject(json.message || "Drive'a kaydedilemedi.");
          resolve();
        }catch(e){
          reject(e?.message || "Y√ºkleme hatasƒ±");
        }
      };

      reader.onerror = ()=> reject("Dosya okunamadƒ±.");
      reader.readAsDataURL(file);
    });
  }
</script>
</body>
</html>
