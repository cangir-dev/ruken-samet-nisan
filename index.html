<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Ruken & Samet | Ni≈üan Anƒ±larƒ±</title>

  <style>
    :root{
      --bg1:#eef7f2;
      --bg2:#d6eee2;

      --forest:#14362a;
      --pine:#1f4a39;
      --pine2:#2a5c47;
      --gold:#c9b27d;

      --text:#0f261e;
      --muted:#24483c;

      --card: rgba(255,255,255,.93);
      --stroke: rgba(20,54,42,.16);
      --shadow: 0 26px 70px rgba(10, 28, 21, .22);
      --radius: 26px;

      --ok:#157a37;
      --err:#c62828;
    }

    *{ box-sizing:border-box; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial; }

    body{
      margin:0;
      min-height:100vh;
      padding: max(18px, env(safe-area-inset-top)) 14px max(22px, env(safe-area-inset-bottom));
      display:grid;
      place-items:center;
      color:var(--text);
      background:
        radial-gradient(1000px 650px at 12% 18%, var(--bg2), transparent 62%),
        radial-gradient(1000px 650px at 88% 82%, var(--bg2), transparent 62%),
        linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg1));
      overflow-x:hidden;
    }

    /* Floral overlay */
    .bg-art{ position:fixed; inset:0; pointer-events:none; z-index:0; }
    .bg-art::before{
      content:""; position:absolute; inset:-40px; opacity:.18;
      background:
        radial-gradient(circle at 12% 22%, rgba(31,74,57,.20) 0 18px, transparent 19px),
        radial-gradient(circle at 88% 30%, rgba(31,74,57,.16) 0 22px, transparent 23px),
        radial-gradient(circle at 22% 86%, rgba(31,74,57,.10) 0 24px, transparent 25px),
        radial-gradient(900px 600px at 12% 10%, rgba(183,215,196,.26), transparent 60%),
        radial-gradient(900px 600px at 90% 30%, rgba(165,203,181,.20), transparent 60%),
        radial-gradient(900px 600px at 30% 92%, rgba(200,225,212,.18), transparent 60%);
      filter: blur(.25px);
    }

    .wrap{ width:min(680px, 100%); position:relative; z-index:1; }

    /* Poster */
    .poster{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .poster::before{
      content:"";
      position:absolute;
      inset:12px;
      border-radius: calc(var(--radius) - 12px);
      border: 1px solid rgba(20,54,42,.14);
      pointer-events:none;
    }

    .topband{
      padding: 18px 18px 16px;
      background: linear-gradient(135deg, var(--forest), var(--pine2));
      color:#fff;
      position:relative;
    }
    .topband::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(520px 240px at 15% 25%, rgba(255,255,255,.14), transparent 60%),
        radial-gradient(520px 240px at 90% 85%, rgba(255,255,255,.10), transparent 60%);
      opacity:.55;
      pointer-events:none;
    }

    .toprow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.22);
      font-size: 12px;
      white-space:nowrap;
    }
    .date{
      font-size: 12px;
      opacity:.92;
      white-space:nowrap;
    }

    .title{
      margin: 12px 0 4px;
      font-size: 34px;
      letter-spacing:.2px;
      position:relative;
      z-index:1;
    }
    .subtitle{
      margin:0;
      font-size: 14px;
      opacity:.95;
      line-height:1.45;
      position:relative;
      z-index:1;
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .goldline{
      height:2px;
      width:78px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
      border-radius: 999px;
      opacity:.85;
      margin-top:10px;
      position:relative;
      z-index:1;
    }

    .content{ padding: 16px 18px 18px; }

    /* Dropzone */
    .dropzone{
      border: 2px dashed rgba(20,54,42,.33);
      border-radius: 18px;
      padding: 14px;
      background: rgba(255,255,255,.84);
      transition: .2s ease;
      cursor:pointer;
      user-select:none;
    }
    .dropzone:hover{
      background: rgba(255,255,255,.99);
      border-color: rgba(20,54,42,.55);
      transform: translateY(-1px);
    }
    .dropzone.dragover{
      background: rgba(231, 246, 239, .97);
      border-color: rgba(20,54,42,.80);
    }
    .dz-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
      flex-wrap:wrap;
    }
    .dz-title{
      font-weight: 950;
      color: var(--forest);
      font-size: 15px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .dz-meta{
      font-size: 12px;
      color: var(--muted);
      background: rgba(20,54,42,.06);
      border: 1px solid rgba(20,54,42,.12);
      padding: 6px 10px;
      border-radius: 999px;
      white-space:nowrap;
    }
    .dz-hint{ margin:0; font-size: 13px; color: rgba(36,72,60,.95); line-height:1.45; }
    input[type=file]{ display:none; }

    /* List */
    .filelist{
      margin-top: 12px;
      display:none;
      border-radius: 16px;
      border: 1px solid rgba(20,54,42,.14);
      background: rgba(255,255,255,.88);
      overflow:hidden;
    }
    .filelist-head{
      padding: 10px 12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      font-size: 12px;
      color: rgba(36,72,60,.95);
      background: rgba(20,54,42,.05);
      border-bottom: 1px solid rgba(20,54,42,.10);
    }
    .fileitems{ max-height: 190px; overflow:auto; }

    .fileitem{
      padding: 10px 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      border-bottom: 1px solid rgba(20,54,42,.08);
    }
    .fileitem:last-child{ border-bottom:none; }

    .fname{ display:flex; align-items:center; gap:10px; min-width:0; }
    .icon{
      width:32px; height:32px; border-radius: 11px;
      display:grid; place-items:center;
      background: rgba(20,54,42,.10);
      color: var(--forest);
      flex:0 0 auto;
      font-size: 15px;
    }
    .fname b{
      display:block;
      font-size: 13px;
      font-weight: 950;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 360px;
    }
    .fname span{ display:block; font-size: 12px; color: rgba(36,72,60,.92); }

    .remove{
      border:none;
      background: rgba(255,255,255,.95);
      border: 1px solid rgba(20,54,42,.16);
      color: rgba(36,72,60,.95);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 950;
      flex:0 0 auto;
    }

    /* Buttons: tek par√ßa gibi (aynƒ± y√ºkseklik, aynƒ± radius, tam oturur) */
    .actions{
      margin-top: 12px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .btn{
      width:100%;
      padding: 14px 14px;
      border:none;
      border-radius: 16px;
      cursor:pointer;
      font-size: 15px;
      font-weight: 950;
      letter-spacing:.2px;
      transition:.18s ease;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:10px;
      min-height: 50px;
    }
    .btn.primary{
      color:#fff;
      background: linear-gradient(135deg, var(--forest), var(--pine2));
      box-shadow: 0 16px 34px rgba(20,54,42,.30);
    }
    .btn.secondary{
      background: rgba(255,255,255,.94);
      color: var(--forest);
      border: 1px solid rgba(20,54,42,.18);
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:disabled{ opacity:.55; cursor:not-allowed; transform:none; }

    /* Progress */
    .progresswrap{ margin-top: 12px; display:none; }
    progress{
      width:100%;
      height: 12px;
      border-radius: 999px;
      overflow:hidden;
      border: 1px solid rgba(20,54,42,.16);
      background: rgba(255,255,255,.95);
    }
    .small{
      margin-top: 8px;
      font-size: 12px;
      color: rgba(36,72,60,.95);
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:center;
    }
    .small #currentFile{
      max-width: 58%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    /* Status */
    .status{
      margin-top: 10px;
      font-size: 13px;
      color: rgba(36,72,60,.95);
      min-height: 18px;
      line-height:1.35;
    }

    .bottomband{
      padding: 12px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      border-top: 1px solid rgba(20,54,42,.12);
      background: rgba(20,54,42,.04);
      font-size: 12px;
      color: rgba(36,72,60,.95);
      flex-wrap:wrap;
    }
    .bottomband b{ color: var(--forest); font-weight: 950; }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      bottom: max(14px, env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(15,38,30,.92);
      color:#fff;
      padding: 10px 12px;
      border-radius: 14px;
      font-size: 13px;
      box-shadow: 0 18px 40px rgba(0,0,0,.18);
      display:none;
      z-index:10;
      max-width: min(520px, 92vw);
    }

    /* Mobile */
    @media (max-width:560px){
      body{ padding: max(14px, env(safe-area-inset-top)) 12px max(18px, env(safe-area-inset-bottom)); }
      .title{ font-size: 28px; }
      .actions{ grid-template-columns: 1fr; }
      .fname b{ max-width: 210px; }
      .fileitems{ max-height: 165px; }
      .date{ opacity:.9; }
    }
  </style>
</head>

<body>
  <div class="bg-art"></div>
  <div class="toast" id="toast"></div>

  <div class="wrap">
    <div class="poster">
      <div class="topband">
        <div class="toprow">
          <div class="tag">üíç Ni≈üan Anƒ± Kutusu ‚Ä¢ Fotoƒüraf & Video</div>
          <div class="date" id="dateLabel"></div>
        </div>
        <div class="title">Ruken & Samet</div>
        <p class="subtitle">Anƒ±larƒ±nƒ±zƒ± bizimle payla≈üƒ±n <span aria-hidden="true">üåø</span></p>
        <div class="goldline"></div>
      </div>

      <div class="content">
        <label class="dropzone" id="dropzone" for="fileInput">
          <div class="dz-top">
            <div class="dz-title">üì∏ Fotoƒüraf / üé• Video se√ßin</div>
            <div class="dz-meta">Maks: 25 dosya</div>
          </div>
          <p class="dz-hint">Tƒ±klayƒ±n veya s√ºr√ºkleyip bƒ±rakƒ±n. Y√ºkleme sƒ±rayla yapƒ±lƒ±r.</p>
          <input id="fileInput" type="file" multiple accept="image/*,video/*">
        </label>

        <div class="filelist" id="filelist">
          <div class="filelist-head">
            <div id="countLabel">0 dosya</div>
            <div id="sizeLabel">0 MB</div>
          </div>
          <div class="fileitems" id="fileitems"></div>
        </div>

        <div class="actions">
          <button class="btn secondary" id="clearBtn" type="button" disabled>üßπ Temizle</button>
          <button class="btn primary" id="uploadBtn" type="button" disabled>‚¨ÜÔ∏è Y√ºklemeyi Ba≈ülat</button>
        </div>

        <div class="progresswrap" id="progresswrap">
          <progress id="progress" value="0" max="100"></progress>
          <div class="small">
            <span id="progressText">0%</span>
            <span id="currentFile">-</span>
          </div>
        </div>

        <div class="status" id="status"></div>
      </div>

      <div class="bottomband">
        <div>üìå Y√ºkleme bitene kadar sayfayƒ± kapatmayƒ±n.</div>
        <div><b>Ruken</b> & <b>Samet</b> ‚Ä¢ Te≈üekk√ºrler ü§ç</div>
      </div>
    </div>
  </div>

<script>
  // ‚úÖ Senin API URL
  const API_URL = "https://script.google.com/macros/s/AKfycbzWZyw9dc1IWQ0N6GRmWkJCkbq8A3oQYS-7BY3CNUH-LBWefRrW7HRywm1OathQ0Bkh/exec";

  const MAX_FILES = 25;
  const MAX_TOTAL_MB = 250;

  const fileInput = document.getElementById("fileInput");
  const dropzone = document.getElementById("dropzone");
  const filelist = document.getElementById("filelist");
  const fileitems = document.getElementById("fileitems");
  const countLabel = document.getElementById("countLabel");
  const sizeLabel = document.getElementById("sizeLabel");
  const uploadBtn = document.getElementById("uploadBtn");
  const clearBtn = document.getElementById("clearBtn");
  const progresswrap = document.getElementById("progresswrap");
  const progress = document.getElementById("progress");
  const progressText = document.getElementById("progressText");
  const currentFile = document.getElementById("currentFile");
  const statusEl = document.getElementById("status");
  const toastEl = document.getElementById("toast");

  let files = [];

  // Tarih etiketi
  (function setDate(){
    const d = new Date();
    const months = ["Ocak","≈ûubat","Mart","Nisan","Mayƒ±s","Haziran","Temmuz","Aƒüustos","Eyl√ºl","Ekim","Kasƒ±m","Aralƒ±k"];
    document.getElementById("dateLabel").textContent = `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;
  })();

  function showToast(msg){
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(showToast._t);
    showToast._t = setTimeout(()=> toastEl.style.display = "none", 2600);
  }

  function formatMB(bytes){ return (bytes / (1024*1024)).toFixed(bytes > 1024*1024 ? 1 : 2); }
  function totalBytes(list){ return list.reduce((a,f)=>a+f.size,0); }
  function iconFor(file){
    if(file.type.startsWith("image/")) return "üñºÔ∏è";
    if(file.type.startsWith("video/")) return "üé¨";
    return "üìÑ";
  }
  function setStatus(text, color="rgba(36,72,60,.95)"){
    statusEl.textContent = text;
    statusEl.style.color = color;
  }

  function validateAndSet(newFiles){
    if(newFiles.length > MAX_FILES){
      setStatus(`En fazla ${MAX_FILES} dosya y√ºkleyebilirsiniz.`, "var(--err)");
      showToast(`En fazla ${MAX_FILES} dosya`);
      return false;
    }
    const totalMB = totalBytes(newFiles) / (1024*1024);
    if(totalMB > MAX_TOTAL_MB){
      setStatus(`Toplam boyut ${MAX_TOTAL_MB} MB‚Äôƒ± ge√ßemez. (≈ûu an: ${totalMB.toFixed(1)} MB)`, "var(--err)");
      showToast(`Toplam ${MAX_TOTAL_MB} MB sƒ±nƒ±rƒ±`);
      return false;
    }
    files = newFiles;
    renderList();
    return true;
  }

  function renderList(){
    fileitems.innerHTML = "";

    if(files.length === 0){
      filelist.style.display = "none";
      uploadBtn.disabled = true;
      clearBtn.disabled = true;
      setStatus("");
      return;
    }

    filelist.style.display = "block";
    uploadBtn.disabled = false;
    clearBtn.disabled = false;

    countLabel.textContent = `${files.length} dosya`;
    sizeLabel.textContent = `${formatMB(totalBytes(files))} MB`;

    files.forEach((f, idx)=>{
      const row = document.createElement("div");
      row.className = "fileitem";

      const left = document.createElement("div");
      left.className = "fname";

      const ic = document.createElement("div");
      ic.className = "icon";
      ic.textContent = iconFor(f);

      const txt = document.createElement("div");
      const name = document.createElement("b");
      name.textContent = f.name;

      const meta = document.createElement("span");
      meta.textContent = `${formatMB(f.size)} MB ‚Ä¢ ${f.type || "dosya"}`;

      txt.appendChild(name);
      txt.appendChild(meta);

      left.appendChild(ic);
      left.appendChild(txt);

      const btn = document.createElement("button");
      btn.className = "remove";
      btn.type = "button";
      btn.textContent = "Sil";
      btn.onclick = ()=>{
        files = files.filter((_, i)=> i !== idx);
        renderList();
      };

      row.appendChild(left);
      row.appendChild(btn);
      fileitems.appendChild(row);
    });

    setStatus("Hazƒ±r. Y√ºklemeyi ba≈ülatabilirsiniz.");
  }

  fileInput.addEventListener("change", (e)=>{
    validateAndSet([...e.target.files]);
  });

  // Drag & drop
  ["dragenter","dragover"].forEach(ev=>{
    dropzone.addEventListener(ev, (e)=>{
      e.preventDefault(); e.stopPropagation();
      dropzone.classList.add("dragover");
    });
  });
  ["dragleave","drop"].forEach(ev=>{
    dropzone.addEventListener(ev, (e)=>{
      e.preventDefault(); e.stopPropagation();
      dropzone.classList.remove("dragover");
    });
  });
  dropzone.addEventListener("drop", (e)=>{
    const dropped = [...e.dataTransfer.files].filter(f => f.type.startsWith("image/") || f.type.startsWith("video/"));
    if(dropped.length === 0){
      setStatus("Sadece fotoƒüraf veya video bƒ±rakabilirsiniz.", "var(--err)");
      showToast("Sadece fotoƒüraf/video");
      return;
    }
    validateAndSet(dropped);
  });

  clearBtn.addEventListener("click", ()=>{
    files = [];
    fileInput.value = "";
    progresswrap.style.display = "none";
    progress.value = 0;
    progressText.textContent = "0%";
    currentFile.textContent = "-";
    renderList();
    showToast("Temizlendi");
  });

  uploadBtn.addEventListener("click", startUpload);

  async function startUpload(){
    if(!API_URL || !API_URL.includes("/exec")){
      setStatus("API_URL hatalƒ± g√∂r√ºn√ºyor. /exec ile bitmeli.", "var(--err)");
      return;
    }
    if(files.length === 0){
      setStatus("Dosya se√ßilmedi.", "var(--err)");
      return;
    }

    uploadBtn.disabled = true;
    clearBtn.disabled = true;
    fileInput.disabled = true;

    progresswrap.style.display = "block";
    progress.value = 0;
    progressText.textContent = "0%";
    setStatus("Y√ºkleme ba≈üladƒ±‚Ä¶");

    let done = 0;

    for(const file of files){
      currentFile.textContent = file.name;

      try{
        await uploadFile(file);
        done++;
        const pct = Math.round((done / files.length) * 100);
        progress.value = pct;
        progressText.textContent = pct + "%";
      }catch(err){
        setStatus("HATA: " + err, "var(--err)");
        uploadBtn.disabled = false;
        clearBtn.disabled = false;
        fileInput.disabled = false;
        return;
      }
    }

    setStatus("üéâ T√ºm dosyalar ba≈üarƒ±yla y√ºklendi!", "var(--ok)");
    currentFile.textContent = "Bitti";
    showToast("Y√ºkleme tamam ‚úÖ");

    files = [];
    fileInput.value = "";
    renderList();

    uploadBtn.disabled = true;
    clearBtn.disabled = true;
    fileInput.disabled = false;
  }

  function uploadFile(file){
    return new Promise((resolve, reject)=>{
      const reader = new FileReader();

      reader.onload = async ()=>{
        try{
          const base64 = String(reader.result).split(",")[1];

          const res = await fetch(API_URL, {
            method: "POST",
            body: new URLSearchParams({
              file: base64,
              originalName: file.name,   // ‚úÖ uzantƒ± buradan alƒ±nacak
              type: file.type
            })
          });

          const text = await res.text();
          let json;
          try { json = JSON.parse(text); }
          catch { return reject("Sunucu JSON d√∂nmedi. Deploy ayarlarƒ±nƒ± kontrol edin."); }

          if(json.status !== "ok"){
            return reject(json.message || "Drive'a kaydedilemedi");
          }

          resolve();
        }catch{
          reject("Y√ºkleme hatasƒ±");
        }
      };

      reader.onerror = ()=>reject("Dosya okunamadƒ±");
      reader.readAsDataURL(file);
    });
  }
</script>
</body>
</html>
