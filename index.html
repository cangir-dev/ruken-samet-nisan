<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="light" />
  <title>Ruken & Samet | Ni≈üan Anƒ±larƒ±</title>

  <style>
    /* =========================
       Premium theme (clean)
    ========================== */
    :root{
      --bg: #eef6f0;
      --ink: #0d1b15;
      --muted: rgba(13,27,21,.72);

      --brand-900:#0f2f24;
      --brand-700:#1e4b3a;
      --brand-600:#2a5c47;

      --gold:#cbb57e;
      --card: rgba(255,255,255,.86);
      --card-strong: rgba(255,255,255,.92);
      --stroke: rgba(15,47,36,.12);

      --shadow: 0 28px 80px rgba(10,28,21,.18);
      --shadow-soft: 0 10px 30px rgba(10,28,21,.10);

      --radius-xl: 28px;
      --radius-lg: 18px;
      --radius-md: 14px;

      --ok:#167a3a;
      --err:#c62828;

      /* üëá background image path */
      --bg-image: url("assets/floral-bg.png");
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      color: var(--ink);
      background: var(--bg);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;

      padding:
        max(18px, env(safe-area-inset-top))
        14px
        max(22px, env(safe-area-inset-bottom));
      display:grid;
      place-items:center;
      overflow-x:hidden;
    }

    /* =========================
       Background (soft & elegant)
    ========================== */
    .bg{
      position:fixed;
      inset:0;
      z-index:0;
      pointer-events:none;
      overflow:hidden;
      background:
        radial-gradient(1000px 700px at 20% 15%, rgba(214,238,226,.65), transparent 60%),
        radial-gradient(1000px 700px at 80% 85%, rgba(214,238,226,.55), transparent 60%),
        linear-gradient(135deg, rgba(245,250,247,.92), rgba(226,242,233,.92));
    }

    .bg::before{
      content:"";
      position:absolute;
      inset:-60px;
      background: var(--bg-image) center/cover no-repeat;
      opacity:.22;
      filter: blur(14px) saturate(1.06);
      transform: scale(1.08);
    }

    .bg::after{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(180deg, rgba(255,255,255,.70), rgba(255,255,255,.40));
      opacity:.65;
    }

    /* =========================
       Layout
    ========================== */
    .wrap{
      width:min(820px, 100%);
      position:relative;
      z-index:1;
    }

    .card{
      border-radius: var(--radius-xl);
      background: var(--card);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }

    .header{
      padding: 18px 18px 16px;
      background: linear-gradient(135deg, var(--brand-900), var(--brand-600));
      color: #fff;
      position:relative;
    }
    .header::after{
      content:"";
      position:absolute;
      inset:0;
      background:
        radial-gradient(520px 260px at 18% 22%, rgba(255,255,255,.16), transparent 62%),
        radial-gradient(520px 260px at 90% 88%, rgba(255,255,255,.12), transparent 60%);
      opacity:.55;
      pointer-events:none;
    }

    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }

    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      font-size: 12px;
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.22);
      white-space:nowrap;
    }

    .date{
      font-size: 12px;
      opacity:.92;
      white-space:nowrap;
    }

    .title{
      margin: 12px 0 4px;
      font-size: 34px;
      letter-spacing:.2px;
      position:relative;
      z-index:1;
    }

    .subtitle{
      margin:0;
      font-size: 14px;
      opacity:.95;
      line-height:1.45;
      position:relative;
      z-index:1;
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }

    .accent-line{
      height:2px;
      width:96px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
      border-radius:999px;
      opacity:.9;
      margin-top:10px;
      position:relative;
      z-index:1;
    }

    .content{
      padding: 16px 18px 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.86));
    }

    /* =========================
       Dropzone
    ========================== */
    .dropzone{
      display:block;
      width:100%;
      border-radius: var(--radius-lg);
      border: 1.5px dashed rgba(15,47,36,.42);
      background: var(--card-strong);
      padding: 16px;
      cursor:pointer;
      user-select:none;
      transition: transform .16s ease, border-color .16s ease, box-shadow .16s ease, background .16s ease;
      box-shadow: var(--shadow-soft);
      outline: none;
    }
    .dropzone:hover{
      transform: translateY(-1px);
      border-color: rgba(15,47,36,.65);
    }
    .dropzone:focus-visible{
      box-shadow: 0 0 0 4px rgba(203,181,126,.35), var(--shadow-soft);
      border-color: rgba(203,181,126,.85);
    }
    .dropzone.dragover{
      background: rgba(231, 246, 239, .96);
      border-color: rgba(15,47,36,.90);
      transform: translateY(-1px);
    }

    .dz-top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }

    .dz-title{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight: 850;
      color: var(--brand-900);
      font-size: 15px;
    }

    .pill{
      font-size: 12px;
      color: rgba(13,27,21,.72);
      background: rgba(15,47,36,.06);
      border: 1px solid rgba(15,47,36,.10);
      padding: 6px 10px;
      border-radius: 999px;
      white-space:nowrap;
    }

    .dz-hint{
      margin:0;
      color: rgba(13,27,21,.70);
      font-size: 13px;
      line-height:1.45;
    }

    input[type=file]{ display:none; }

    /* =========================
       File list
    ========================== */
    .panel{
      margin-top: 12px;
      border-radius: var(--radius-lg);
      border: 1px solid rgba(15,47,36,.12);
      background: rgba(255,255,255,.88);
      overflow:hidden;
      display:none;
    }

    .panel-head{
      padding: 10px 12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      font-size: 12px;
      color: rgba(13,27,21,.76);
      background: rgba(15,47,36,.05);
      border-bottom: 1px solid rgba(15,47,36,.08);
    }

    .items{
      max-height: 210px;
      overflow:auto;
    }

    .item{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(15,47,36,.06);
    }
    .item:last-child{ border-bottom:none; }

    .left{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }

    .icon{
      width:34px;
      height:34px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      background: rgba(15,47,36,.08);
      color: var(--brand-900);
      flex:0 0 auto;
      font-size: 16px;
    }

    .meta{ min-width:0; }
    .name{
      display:block;
      font-size: 13px;
      font-weight: 850;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 420px;
    }
    .sub{
      display:block;
      font-size: 12px;
      color: rgba(13,27,21,.70);
    }

    .ghost{
      border: 1px solid rgba(15,47,36,.14);
      background: rgba(255,255,255,.92);
      color: rgba(13,27,21,.78);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 800;
      transition: transform .16s ease, background .16s ease;
      flex: 0 0 auto;
    }
    .ghost:hover{ transform: translateY(-1px); background: rgba(255,255,255,.98); }

    /* =========================
       Actions
    ========================== */
    .actions{
      margin-top: 12px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }

    .btn{
      width:100%;
      border:none;
      border-radius: var(--radius-lg);
      padding: 14px 14px;
      font-size: 15px;
      font-weight: 900;
      letter-spacing:.2px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      min-height: 52px;
      transition: transform .16s ease, filter .16s ease, box-shadow .16s ease;
    }

    .btn-primary{
      color:#fff;
      background: linear-gradient(135deg, var(--brand-900), var(--brand-600));
      box-shadow: 0 18px 40px rgba(15,47,36,.22);
    }
    .btn-primary:hover{ transform: translateY(-1px); filter: brightness(1.02); }

    .btn-secondary{
      background: rgba(255,255,255,.95);
      color: var(--brand-900);
      border: 1px solid rgba(15,47,36,.16);
      box-shadow: 0 10px 24px rgba(10,28,21,.10);
    }
    .btn-secondary:hover{ transform: translateY(-1px); }

    .btn:disabled{
      opacity:.52;
      cursor:not-allowed;
      transform:none !important;
      box-shadow:none;
    }

    /* =========================
       Progress & status
    ========================== */
    .progresswrap{
      margin-top: 12px;
      display:none;
      border-radius: var(--radius-lg);
      border: 1px solid rgba(15,47,36,.12);
      background: rgba(255,255,255,.88);
      padding: 12px;
    }

    progress{
      width:100%;
      height: 12px;
      border-radius: 999px;
      overflow:hidden;
      border: 1px solid rgba(15,47,36,.14);
      background: rgba(255,255,255,.96);
    }
    progress::-webkit-progress-bar{ background: rgba(255,255,255,.96); }
    progress::-webkit-progress-value{
      background: linear-gradient(90deg, var(--brand-700), var(--gold));
      border-radius:999px;
    }

    .small{
      margin-top: 8px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      font-size: 12px;
      color: rgba(13,27,21,.76);
    }
    #currentFile{
      max-width: 60%;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .status{
      margin-top: 10px;
      font-size: 13px;
      min-height: 18px;
      line-height:1.35;
      color: rgba(13,27,21,.76);
    }

    /* =========================
       Footer
    ========================== */
    .footer{
      padding: 12px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      border-top: 1px solid rgba(15,47,36,.10);
      background: rgba(15,47,36,.035);
      font-size: 12px;
      color: rgba(13,27,21,.76);
    }
    .footer b{ color: var(--brand-900); font-weight: 900; }

    /* =========================
       Toast
    ========================== */
    .toast{
      position:fixed;
      left:50%;
      bottom: max(14px, env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(13,27,21,.92);
      color:#fff;
      padding: 10px 12px;
      border-radius: 14px;
      font-size: 13px;
      box-shadow: 0 18px 40px rgba(0,0,0,.18);
      display:none;
      z-index:10;
      max-width: min(520px, 92vw);
    }

    @media (max-width:560px){
      .title{ font-size: 28px; }
      .actions{ grid-template-columns: 1fr; }
      .name{ max-width: 240px; }
      .items{ max-height: 180px; }
    }

    @media (prefers-reduced-motion: reduce){
      *{ transition:none !important; scroll-behavior:auto !important; }
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <main class="wrap">
    <section class="card" aria-label="Ni≈üan anƒ±larƒ± y√ºkleme paneli">
      <header class="header">
        <div class="row">
          <div class="chip">üíç Ni≈üan Anƒ± Kutusu ‚Ä¢ Fotoƒüraf & Video</div>
          <div class="date" id="dateLabel"></div>
        </div>
        <h1 class="title">Ruken & Samet</h1>
        <p class="subtitle">Anƒ±larƒ±nƒ±zƒ± bizimle payla≈üƒ±n üåø</p>
        <div class="accent-line"></div>
      </header>

      <div class="content">
        <label class="dropzone" id="dropzone" for="fileInput" tabindex="0">
          <div class="dz-top">
            <div class="dz-title">üì∏ Fotoƒüraf / üé• Video se√ßin</div>
            <div class="pill">Maks: 25 dosya ‚Ä¢ Toplam: 250 MB</div>
          </div>
          <p class="dz-hint">Tƒ±klayƒ±n veya dosyalarƒ± s√ºr√ºkleyip bƒ±rakƒ±n. Y√ºkleme sƒ±rayla yapƒ±lƒ±r.</p>
          <input id="fileInput" type="file" multiple accept="image/*,video/*" />
        </label>

        <div class="panel" id="filePanel">
          <div class="panel-head">
            <div id="countLabel">0 dosya</div>
            <div id="sizeLabel">0 MB</div>
          </div>
          <div class="items" id="fileItems"></div>
        </div>

        <div class="actions">
          <button class="btn btn-secondary" id="clearBtn" type="button" disabled>üßπ Temizle</button>
          <button class="btn btn-primary" id="uploadBtn" type="button" disabled>‚¨ÜÔ∏è Y√ºklemeyi Ba≈ülat</button>
        </div>

        <div class="progresswrap" id="progressWrap">
          <progress id="progress" value="0" max="100"></progress>
          <div class="small">
            <span id="progressText">0%</span>
            <span id="currentFile">-</span>
          </div>
        </div>

        <div class="status" id="status"></div>
      </div>

      <footer class="footer">
        <div>üìå Y√ºkleme bitene kadar sayfayƒ± kapatmayƒ±n.</div>
        <div><b>Ruken</b> & <b>Samet</b> ‚Ä¢ Te≈üekk√ºrler ü§ç</div>
      </footer>
    </section>
  </main>

<script>
  /* =========================
     CONFIG
  ========================== */
  const API_URL = "https://script.google.com/macros/s/AKfycbzWZyw9dc1IWQ0N6GRmWkJCkbq8A3oQYS-7BY3CNUH-LBWefRrW7HRywm1OathQ0Bkh/exec";
  const MAX_FILES = 25;
  const MAX_TOTAL_MB = 250;

  /* =========================
     DOM
  ========================== */
  const el = (id) => document.getElementById(id);

  const fileInput    = el("fileInput");
  const dropzone     = el("dropzone");
  const filePanel    = el("filePanel");
  const fileItems    = el("fileItems");
  const countLabel   = el("countLabel");
  const sizeLabel    = el("sizeLabel");
  const uploadBtn    = el("uploadBtn");
  const clearBtn     = el("clearBtn");
  const progressWrap = el("progressWrap");
  const progress     = el("progress");
  const progressText = el("progressText");
  const currentFile  = el("currentFile");
  const statusEl     = el("status");
  const toastEl      = el("toast");

  let files = [];

  /* =========================
     Helpers
  ========================== */
  (function setDate(){
    const d = new Date();
    const months = ["Ocak","≈ûubat","Mart","Nisan","Mayƒ±s","Haziran","Temmuz","Aƒüustos","Eyl√ºl","Ekim","Kasƒ±m","Aralƒ±k"];
    el("dateLabel").textContent = `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;
  })();

  const fmtMB = (bytes) => (bytes / (1024 * 1024)).toFixed(bytes >= 1024 * 1024 ? 1 : 2);
  const sumBytes = (list) => list.reduce((a,f)=> a + f.size, 0);

  function toast(msg){
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(toast._t);
    toast._t = setTimeout(()=> toastEl.style.display = "none", 2400);
  }

  function setStatus(text, kind="default"){
    statusEl.textContent = text || "";
    statusEl.style.color =
      kind === "ok" ? "var(--ok)" :
      kind === "err" ? "var(--err)" :
      "rgba(13,27,21,.76)";
  }

  function iconFor(file){
    if(file.type?.startsWith("image/")) return "üñºÔ∏è";
    if(file.type?.startsWith("video/")) return "üé¨";
    return "üìÑ";
  }

  function isAllowed(file){
    return file.type?.startsWith("image/") || file.type?.startsWith("video/");
  }

  function validate(newFiles){
    if(newFiles.length > MAX_FILES){
      setStatus(`En fazla ${MAX_FILES} dosya y√ºkleyebilirsiniz.`, "err");
      toast(`En fazla ${MAX_FILES} dosya`);
      return false;
    }
    const totalMB = sumBytes(newFiles) / (1024*1024);
    if(totalMB > MAX_TOTAL_MB){
      setStatus(`Toplam boyut ${MAX_TOTAL_MB} MB‚Äôƒ± ge√ßemez. (≈ûu an: ${totalMB.toFixed(1)} MB)`, "err");
      toast(`Toplam ${MAX_TOTAL_MB} MB sƒ±nƒ±rƒ±`);
      return false;
    }
    return true;
  }

  function setFiles(newFiles){
    files = newFiles;
    render();
  }

  function render(){
    fileItems.innerHTML = "";

    if(files.length === 0){
      filePanel.style.display = "none";
      uploadBtn.disabled = true;
      clearBtn.disabled = true;
      setStatus("");
      return;
    }

    filePanel.style.display = "block";
    uploadBtn.disabled = false;
    clearBtn.disabled = false;

    countLabel.textContent = `${files.length} dosya`;
    sizeLabel.textContent = `${fmtMB(sumBytes(files))} MB`;

    for (const [idx, f] of files.entries()){
      const row = document.createElement("div");
      row.className = "item";

      const left = document.createElement("div");
      left.className = "left";

      const ic = document.createElement("div");
      ic.className = "icon";
      ic.textContent = iconFor(f);

      const meta = document.createElement("div");
      meta.className = "meta";

      const name = document.createElement("span");
      name.className = "name";
      name.textContent = f.name;

      const sub = document.createElement("span");
      sub.className = "sub";
      sub.textContent = `${fmtMB(f.size)} MB ‚Ä¢ ${f.type || "dosya"}`;

      meta.appendChild(name);
      meta.appendChild(sub);

      left.appendChild(ic);
      left.appendChild(meta);

      const btn = document.createElement("button");
      btn.className = "ghost";
      btn.type = "button";
      btn.textContent = "Sil";
      btn.addEventListener("click", ()=>{
        files = files.filter((_, i)=> i !== idx);
        if(files.length === 0) fileInput.value = "";
        render();
      });

      row.appendChild(left);
      row.appendChild(btn);
      fileItems.appendChild(row);
    }

    setStatus("Hazƒ±r. Y√ºklemeyi ba≈ülatabilirsiniz.");
  }

  function resetProgress(){
    progressWrap.style.display = "none";
    progress.value = 0;
    progressText.textContent = "0%";
    currentFile.textContent = "-";
  }

  function setBusy(busy){
    uploadBtn.disabled = busy || files.length === 0;
    clearBtn.disabled = busy || files.length === 0;
    fileInput.disabled = busy;
  }

  /* =========================
     Events
  ========================== */
  fileInput.addEventListener("change", (e)=>{
    const picked = [...e.target.files].filter(isAllowed);
    if(picked.length === 0){
      setStatus("Sadece fotoƒüraf veya video se√ßebilirsiniz.", "err");
      toast("Sadece fotoƒüraf/video");
      return;
    }
    if(!validate(picked)) return;
    setFiles(picked);
  });

  // Drag & drop
  ["dragenter","dragover"].forEach(ev=>{
    dropzone.addEventListener(ev, (e)=>{
      e.preventDefault(); e.stopPropagation();
      dropzone.classList.add("dragover");
    });
  });
  ["dragleave","drop"].forEach(ev=>{
    dropzone.addEventListener(ev, (e)=>{
      e.preventDefault(); e.stopPropagation();
      dropzone.classList.remove("dragover");
    });
  });

  dropzone.addEventListener("drop", (e)=>{
    const dropped = [...e.dataTransfer.files].filter(isAllowed);
    if(dropped.length === 0){
      setStatus("Sadece fotoƒüraf veya video bƒ±rakabilirsiniz.", "err");
      toast("Sadece fotoƒüraf/video");
      return;
    }
    if(!validate(dropped)) return;
    setFiles(dropped);
  });

  clearBtn.addEventListener("click", ()=>{
    files = [];
    fileInput.value = "";
    resetProgress();
    render();
    toast("Temizlendi");
  });

  uploadBtn.addEventListener("click", startUpload);

  /* =========================
     Upload
  ========================== */
  async function startUpload(){
    if(files.length === 0){
      setStatus("Dosya se√ßilmedi.", "err");
      return;
    }

    setBusy(true);
    progressWrap.style.display = "block";
    progress.value = 0;
    progressText.textContent = "0%";
    setStatus("Y√ºkleme ba≈üladƒ±‚Ä¶");

    let done = 0;

    try{
      for(const file of files){
        currentFile.textContent = file.name;
        await uploadFile(file);

        done++;
        const pct = Math.round((done / files.length) * 100);
        progress.value = pct;
        progressText.textContent = pct + "%";
      }

      setStatus("üéâ T√ºm dosyalar ba≈üarƒ±yla y√ºklendi!", "ok");
      currentFile.textContent = "Bitti";
      toast("Y√ºkleme tamam ‚úÖ");

      files = [];
      fileInput.value = "";
      render();
      resetProgress();
    }catch(err){
      setStatus("HATA: " + String(err), "err");
    }finally{
      setBusy(false);
      // Eƒüer dosya kalmadƒ±ysa butonlar zaten disable olacak (render i√ßinde)
      render();
    }
  }

  function uploadFile(file){
    return new Promise((resolve, reject)=>{
      const reader = new FileReader();

      reader.onload = async ()=>{
        try{
          const base64 = String(reader.result).split(",")[1];

          const res = await fetch(API_URL, {
            method: "POST",
            body: new URLSearchParams({
              file: base64,
              originalName: file.name,
              type: file.type || "application/octet-stream"
            })
          });

          const text = await res.text();
          let json;
          try { json = JSON.parse(text); }
          catch { return reject("Sunucu JSON d√∂nmedi. Apps Script Deploy ayarlarƒ±nƒ± kontrol edin."); }

          if(json.status !== "ok") return reject(json.message || "Drive'a kaydedilemedi");
          resolve();
        }catch{
          reject("Y√ºkleme hatasƒ± (baƒülantƒ± veya sunucu).");
        }
      };

      reader.onerror = ()=> reject("Dosya okunamadƒ±");
      reader.readAsDataURL(file);
    });
  }
</script>
</body>
</html>
